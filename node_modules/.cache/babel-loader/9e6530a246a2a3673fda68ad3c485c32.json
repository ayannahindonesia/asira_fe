{"ast":null,"code":"import axios from 'axios';\nimport Cookie from 'universal-cookie';\nimport jsonWebToken from 'jsonwebtoken';\nimport { serverUrl, serverUrlBorrower } from '../url';\nimport { setTokenClient, setTokenBorrower, getTokenAuth } from './token';\nconst cookie = new Cookie();\nexport async function postLoginBankDashboardFunction(param, next, nextProfile) {\n  return new Promise(async resolve => {\n    console.log('hit');\n    const tokenAuth = getTokenAuth();\n    const config = {\n      headers: {\n        'Authorization': \"Bearer \" + tokenAuth\n      }\n    };\n    let newLink = serverUrl + \"client/lender_login\";\n    const logindata = {\n      key: param.key,\n      password: param.password\n    };\n    axios.post(newLink, logindata, config).then(res => {\n      param.dataTokenLender = res.data.token;\n      let date = new Date();\n      date.setTime(date.getTime() + res.data.expires * 1000);\n      delete param.password;\n      cookie.set('tokenClient', res.data.token, {\n        expires: date\n      });\n      setTokenClient(res.data.token, date.getTime() + res.data.expires_in * 1000);\n\n      if (next) {\n        resolve(next(param, nextProfile));\n      }\n\n      resolve(param);\n    }).catch(err => {\n      const error = err.response && err.response.data && err.response.data.message && \"Error : \".concat(err.response.data.message.toString().toUpperCase());\n      param.error = error;\n      resolve(param);\n    });\n  });\n}\nexport async function getTokenBorrowerFunction(param, next) {\n  return new Promise(async resolve => {\n    console.log('hit');\n    let newLink = serverUrlBorrower + \"clientauth\";\n    const logindata = {\n      auth: {\n        username: 'androkey',\n        password: 'androsecret'\n      }\n    };\n    axios.get(newLink, logindata).then(res => {\n      const date = new Date();\n      date.setTime(date.getTime() + res.data.expires * 1000);\n      param.dataTokenBorrower = res.data.token;\n      cookie.set('tokenBorrower', res.data.token, {\n        expires: date\n      });\n      setTokenBorrower(res.data.token);\n\n      if (next) {\n        resolve(next(param));\n      }\n\n      resolve(param);\n    }).catch(err => {\n      const error = err.response && err.response.data && err.response.data.message && \"Error : \".concat(err.response.data.message.toString().toUpperCase());\n      param.error = error;\n      resolve(param);\n    });\n  });\n}\nexport async function getUserProfileFunction(param, next, nextPermission) {\n  return new Promise(async resolve => {\n    try {\n      console.log('hit');\n      var token = jsonWebToken.verify(param.dataToken, 'sXQ8jUMpueOvN5P3cdCR');\n      param.dataPermission = token.permissions;\n      resolve(param);\n    } catch (err) {\n      console.log(err.toString());\n      const error = err.response && err.response.data && err.response.data.message && \"Error : \".concat(err.response.data.message.toString().toUpperCase()) || 'Gagal melihat profile User';\n      param.error = error;\n      resolve(param);\n    }\n  });\n}","map":{"version":3,"sources":["C:\\Users\\pc\\Desktop\\asira_fe\\src\\components\\index\\saga.js"],"names":["axios","Cookie","jsonWebToken","serverUrl","serverUrlBorrower","setTokenClient","setTokenBorrower","getTokenAuth","cookie","postLoginBankDashboardFunction","param","next","nextProfile","Promise","resolve","console","log","tokenAuth","config","headers","newLink","logindata","key","password","post","then","res","dataTokenLender","data","token","date","Date","setTime","getTime","expires","set","expires_in","catch","err","error","response","message","toString","toUpperCase","getTokenBorrowerFunction","auth","username","get","dataTokenBorrower","getUserProfileFunction","nextPermission","verify","dataToken","dataPermission","permissions"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport Cookie from 'universal-cookie'\r\nimport jsonWebToken from 'jsonwebtoken'\r\nimport {serverUrl, serverUrlBorrower} from '../url'\r\nimport { setTokenClient, setTokenBorrower, getTokenAuth } from './token'\r\nconst cookie = new Cookie()\r\n\r\nexport async function postLoginBankDashboardFunction (param, next, nextProfile) {\r\n    return new Promise(async (resolve)=>{\r\n        console.log('hit')\r\n        const tokenAuth = getTokenAuth();\r\n\r\n        const config = {\r\n            headers: {'Authorization': \"Bearer \" + tokenAuth}\r\n        };\r\n\r\n        let newLink = serverUrl+`client/lender_login`;  \r\n        const logindata ={key: param.key,password: param.password};\r\n          \r\n        axios.post(newLink, logindata, config)\r\n        .then((res)=>{\r\n            param.dataTokenLender = res.data.token;\r\n            let date = new Date();\r\n            date.setTime(date.getTime() + (res.data.expires*1000));\r\n\r\n            delete param.password;\r\n            cookie.set('tokenClient',res.data.token,{expires: date})\r\n            setTokenClient(res.data.token, date.getTime() + (res.data.expires_in*1000))\r\n\r\n            if(next){\r\n                resolve(next(param, nextProfile))\r\n            }\r\n            resolve(param)\r\n        })\r\n        .catch((err)=>{\r\n            const error = err.response && err.response.data && err.response.data.message && `Error : ${err.response.data.message.toString().toUpperCase()}`\r\n            param.error = error;\r\n            resolve(param);\r\n        })\r\n    })\r\n    \r\n}\r\n\r\nexport async function getTokenBorrowerFunction (param, next) {\r\n    return new Promise(async (resolve)=>{\r\n        console.log('hit')\r\n        let newLink = serverUrlBorrower +`clientauth`;  \r\n        const logindata = {\r\n            auth: {\r\n                username : 'androkey',\r\n                password : 'androsecret'\r\n            }\r\n        };\r\n          \r\n        axios.get(newLink, logindata)\r\n        .then((res)=>{\r\n            const date = new Date();\r\n            date.setTime(date.getTime() + (res.data.expires*1000));\r\n            \r\n            param.dataTokenBorrower = res.data.token;\r\n            cookie.set('tokenBorrower',res.data.token,{expires: date})\r\n\r\n            setTokenBorrower(res.data.token);\r\n\r\n            if(next){\r\n                resolve(next(param))\r\n            }\r\n            resolve(param)\r\n        })\r\n        .catch((err)=>{\r\n            const error = err.response && err.response.data && err.response.data.message && `Error : ${err.response.data.message.toString().toUpperCase()}`\r\n            param.error = error;\r\n            resolve(param);\r\n        })\r\n    })\r\n    \r\n}\r\n\r\nexport async function getUserProfileFunction(param, next, nextPermission) {\r\n    return new Promise(async (resolve) => {    \r\n        try {\r\n            console.log('hit')\r\n            var token = jsonWebToken.verify(param.dataToken,'sXQ8jUMpueOvN5P3cdCR');\r\n\r\n\r\n            param.dataPermission = token.permissions;\r\n            resolve(param)\r\n        } catch (err) {\r\n            console.log(err.toString())\r\n            const error = (err.response && err.response.data && err.response.data.message && `Error : ${err.response.data.message.toString().toUpperCase()}`) || 'Gagal melihat profile User'\r\n            param.error = error\r\n            resolve(param);\r\n        }\r\n        \r\n        \r\n    });\r\n    \r\n}\r\n"]},"metadata":{},"sourceType":"module"}